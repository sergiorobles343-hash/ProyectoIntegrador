package app.ui;import app.db.InspeccionDatabase;import app.model.Inspeccion;import app.model.Tecnico;import javax.swing.*;import javax.swing.border.EmptyBorder;import java.awt.*;import java.util.List;public class ObservacionFrame extends JFrame {    private Tecnico tecnico;    private JComboBox<String> cmbInspecciones;    private JTextArea txtEspecificas;    private List<Inspeccion> listaInspecciones;     public ObservacionFrame(Tecnico tecnico) {        this.tecnico = tecnico;        setTitle("Ingresar Observaciones");        setSize(700, 600);        setLocationRelativeTo(null);        setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);        initUI();        cargarInspecciones();    }    private void initUI() {        JPanel mainPanel = new JPanel(new BorderLayout());        mainPanel.setBackground(Color.WHITE);        mainPanel.setBorder(new EmptyBorder(30, 35, 30, 35));        // Título        JPanel panelTitulo = new JPanel();        panelTitulo.setLayout(new BoxLayout(panelTitulo, BoxLayout.Y_AXIS));        panelTitulo.setBackground(Color.WHITE);        panelTitulo.setBorder(new EmptyBorder(0, 0, 25, 0));        JLabel lblTitulo = new JLabel("Observaciones de Inspecciones");        lblTitulo.setFont(new Font("Poppins", Font.BOLD, 26));        lblTitulo.setForeground(new Color(25, 30, 40));        JLabel lblSubtitulo = new JLabel("Añade observaciones específicas a tus inspecciones");        lblSubtitulo.setFont(new Font("Poppins", Font.PLAIN, 13));        lblSubtitulo.setForeground(new Color(120, 120, 130));        panelTitulo.add(lblTitulo);        panelTitulo.add(Box.createVerticalStrut(5));        panelTitulo.add(lblSubtitulo);        // Formulario        JPanel panelForm = new JPanel(new GridBagLayout());        panelForm.setBackground(new Color(250, 250, 252));        panelForm.setBorder(BorderFactory.createCompoundBorder(            BorderFactory.createLineBorder(new Color(230, 230, 240), 1),            new EmptyBorder(25, 25, 25, 25)        ));        GridBagConstraints gbc = new GridBagConstraints();        gbc.fill = GridBagConstraints.HORIZONTAL;        gbc.insets = new Insets(10, 0, 10, 0);        gbc.weightx = 1.0;        gbc.gridx = 0;        // Seleccionar inspección        gbc.gridy = 0;        panelForm.add(crearLabel("Seleccionar Inspección:"), gbc);        cmbInspecciones = new JComboBox<>();        cmbInspecciones.addItem("-- Seleccione una inspección --");        estilizarCombo(cmbInspecciones);        gbc.gridy = 1;        panelForm.add(cmbInspecciones, gbc);        // Observaciones específicas        gbc.gridy = 2;        gbc.insets = new Insets(20, 0, 10, 0);        panelForm.add(crearLabel("Observaciones Específicas:"), gbc);        gbc.insets = new Insets(10, 0, 10, 0);        txtEspecificas = new JTextArea(10, 40);        txtEspecificas.setLineWrap(true);        txtEspecificas.setWrapStyleWord(true);        txtEspecificas.setFont(new Font("Poppins", Font.PLAIN, 13));        txtEspecificas.setBackground(Color.WHITE);        txtEspecificas.setForeground(new Color(30, 30, 30));        txtEspecificas.setBorder(BorderFactory.createCompoundBorder(            BorderFactory.createLineBorder(new Color(220, 220, 230), 1),            new EmptyBorder(8, 12, 8, 12)        ));        JScrollPane scrollEspecificas = new JScrollPane(txtEspecificas);        scrollEspecificas.setBorder(BorderFactory.createLineBorder(new Color(220, 220, 230), 1));        gbc.gridy = 3;        gbc.weighty = 1.0;        gbc.fill = GridBagConstraints.BOTH;        panelForm.add(scrollEspecificas, gbc);        // Botones        JPanel panelBotones = new JPanel(new GridLayout(1, 2, 15, 0));        panelBotones.setOpaque(false);        JButton btnGuardar = crearBotonPrimario("✓ Guardar", new Color(80, 200, 120));        JButton btnCancelar = crearBotonSecundario("✗ Cancelar");        btnGuardar.addActionListener(e -> guardarObservaciones());        btnCancelar.addActionListener(e -> dispose());        panelBotones.add(btnGuardar);        panelBotones.add(btnCancelar);        gbc.gridy = 4;        gbc.weighty = 0;        gbc.fill = GridBagConstraints.HORIZONTAL;        gbc.insets = new Insets(20, 0, 0, 0);        panelForm.add(panelBotones, gbc);        mainPanel.add(panelTitulo, BorderLayout.NORTH);        mainPanel.add(panelForm, BorderLayout.CENTER);        add(mainPanel);        // Evento para cargar observación existente        cmbInspecciones.addActionListener(e -> cargarObservacionExistente());    }    private void cargarInspecciones() {        if (tecnico == null) {            JOptionPane.showMessageDialog(this,                 "⚠ Error: No hay técnico asignado",                 "Error",                 JOptionPane.ERROR_MESSAGE);            return;        }        listaInspecciones = InspeccionDatabase.getInspeccionesPorTecnico(tecnico.getId());        cmbInspecciones.removeAllItems();        cmbInspecciones.addItem("-- Seleccione una inspección --");        if (listaInspecciones == null || listaInspecciones.isEmpty()) {            JOptionPane.showMessageDialog(this,                 "No hay inspecciones para este técnico.",                "Información",                 JOptionPane.INFORMATION_MESSAGE);            return;        }        for (Inspeccion i : listaInspecciones) {            String texto = (i.getPredio() != null ? i.getPredio() : "Sin predio")                    + " - " + (i.getCultivo() != null ? i.getCultivo() : "Sin cultivo")                    + " - " + (i.getPlaga() != null ? i.getPlaga() : "Sin plaga")                    + " - " + (i.getFecha() != null ? i.getFecha().toString() : "Sin fecha");            cmbInspecciones.addItem(texto);        }    }    private void cargarObservacionExistente() {        int index = cmbInspecciones.getSelectedIndex();        if (index <= 0) {            txtEspecificas.setText("");            return;        }        Inspeccion ins = listaInspecciones.get(index - 1);        txtEspecificas.setText(                ins.getObservacionesEspecificas() != null                        ? ins.getObservacionesEspecificas()                        : ""        );    }    private void guardarObservaciones() {        int index = cmbInspecciones.getSelectedIndex();        if (index <= 0) {            JOptionPane.showMessageDialog(this,                 "Seleccione una inspección",                 "Validación",                 JOptionPane.WARNING_MESSAGE);            return;        }        String texto = txtEspecificas.getText().trim();        if (texto.isEmpty()) {            JOptionPane.showMessageDialog(this,                 "Debe ingresar observaciones",                 "Validación",                 JOptionPane.WARNING_MESSAGE);            return;        }        Inspeccion ins = listaInspecciones.get(index - 1);        int idInspeccion = ins.getId();        if (idInspeccion <= 0) {            JOptionPane.showMessageDialog(this,                 "❌ La inspección no tiene ID asignado",                 "Error",                 JOptionPane.ERROR_MESSAGE);            return;        }        boolean actualizado = InspeccionDatabase.actualizarObservacionesEspecificas(idInspeccion, texto);        if (actualizado) {            ins.setObservacionesEspecificas(texto);            JOptionPane.showMessageDialog(this,                    "✅ Observación guardada correctamente\n\n" +                            "Predio: " + ins.getPredio() + "\n" +                            "Cultivo: " + ins.getCultivo() + "\n" +                            "Plaga: " + ins.getPlaga() + "\n" +                            "Fecha: " + ins.getFecha(),                    "Éxito",                    JOptionPane.INFORMATION_MESSAGE);            dispose();        } else {            JOptionPane.showMessageDialog(this,                    "❌ Error al actualizar en la BD",                    "Error",                    JOptionPane.ERROR_MESSAGE);        }    }    // Métodos de estilo    private JLabel crearLabel(String texto) {        JLabel lbl = new JLabel(texto);        lbl.setFont(new Font("Poppins", Font.PLAIN, 13));        lbl.setForeground(new Color(70, 70, 80));        return lbl;    }    private void estilizarCombo(JComboBox<String> combo) {        combo.setFont(new Font("Poppins", Font.PLAIN, 13));        combo.setBackground(Color.WHITE);        combo.setForeground(new Color(30, 30, 30));        combo.setBorder(BorderFactory.createLineBorder(new Color(220, 220, 230), 1));    }    private JButton crearBotonPrimario(String texto, Color colorFondo) {        JButton boton = new JButton(texto);        boton.setFont(new Font("Poppins", Font.BOLD, 13));        boton.setForeground(Color.WHITE);        boton.setBackground(colorFondo);        boton.setFocusPainted(false);        boton.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));        boton.setBorder(new EmptyBorder(10, 20, 10, 20));        boton.addMouseListener(new java.awt.event.MouseAdapter() {            Color original = colorFondo;            @Override            public void mouseEntered(java.awt.event.MouseEvent e) {                boton.setBackground(original.darker());            }            @Override            public void mouseExited(java.awt.event.MouseEvent e) {                boton.setBackground(original);            }        });        return boton;    }    private JButton crearBotonSecundario(String texto) {        JButton boton = new JButton(texto);        boton.setFont(new Font("Poppins", Font.BOLD, 13));        boton.setForeground(new Color(70, 130, 255));        boton.setBackground(Color.WHITE);        boton.setFocusPainted(false);        boton.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));        boton.setBorder(BorderFactory.createCompoundBorder(            BorderFactory.createLineBorder(new Color(220, 220, 230), 1),            new EmptyBorder(9, 19, 9, 19)        ));        boton.addMouseListener(new java.awt.event.MouseAdapter() {            @Override            public void mouseEntered(java.awt.event.MouseEvent e) {                boton.setBackground(new Color(245, 247, 250));            }            @Override            public void mouseExited(java.awt.event.MouseEvent e) {                boton.setBackground(Color.WHITE);            }        });        return boton;    }}